package com.prf.inventario.controller;

import javax.validation.Valid;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;

import com.prf.inventario.model.LoginUsuario;
import com.prf.inventario.service.LoginUsuarioService;

@Controller
@RequestMapping("/login")
public class LoginUsuarioController {
	
	@Autowired
	private LoginUsuarioService loginUsuarioService;
	
	@GetMapping("")
	public ModelAndView listaLogins() {
		ModelAndView mv = new ModelAndView("login/index");
		Iterable<LoginUsuario> loginUsuarios = loginUsuarioService.listarLoginUsuarios();
		mv.addObject("loginUsuarios", loginUsuarios); 
		return mv;
	}
	
	
	@GetMapping("novoLoginUsuario")
	public ModelAndView novoLoginUsuario(LoginUsuario loginUsuario) {
		
		ModelAndView mv = new ModelAndView("login/novoLoginUsuario");
		mv.addObject("loginUsuario", loginUsuario);		
		return mv;
	}
	
	@PostMapping("salvarLoginUsuario")
	public ModelAndView salvarUsuario(@Valid LoginUsuario loginUsuario , BindingResult result) {
		if(result.hasErrors()) {
			return novoLoginUsuario(loginUsuario);
		}
		loginUsuarioService.salvarLoginUsuario(loginUsuario);
		return listaLogins();
	}
	
	

	/*
	@GetMapping("editarLoginUsuario/{id}")
	public ModelAndView editarLoginUsuario(@PathVariable("id") int id, HttpSession sessao) {
		ModelAndView mv = new ModelAndView("/login/editarLoginUsuario");
		Optional<LoginUsuario> loginUsuario = loginUsuarioService.buscarLoginUsuarioId(id);
		mv.addObject("loginUsuario", loginUsuario);
		
		sessao.setAttribute("loginUsuario", loginUsuario.get());
		
	}	
	*/
}
